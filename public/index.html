<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Roni Mod Menu ‚Äî Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body {
    background: #0a0a0a;
    color: #00ff99;
    font-family: monospace;
    text-align: center;
    padding: 20px;
  }
  input, button {
    margin: 8px;
    padding: 8px;
    background: black;
    color: #00ff99;
    border: 1px solid #00ff99;
    border-radius: 6px;
  }
  button:hover { background: #00ff99; color: black; }
  table {
    margin: 20px auto;
    border-collapse: collapse;
    width: 90%;
  }
  th, td {
    border: 1px solid #00ff99;
    padding: 8px;
  }
  .delete-btn {
    color: red;
    border: 1px solid red;
  }
  .delete-btn:hover {
    background: red;
    color: white;
  }
</style>
</head>
<body>
  <h2>‚ò†Ô∏èRoni Mod Menu‚ò†Ô∏è</h2>

  <input id="newKey" placeholder="Enter new key">
  <input id="days" placeholder="Days valid">
  <button onclick="addKey()">Add Key</button>

  <table id="keysTable">
    <thead>
      <tr><th>Key</th><th>Active</th><th>Expiry</th><th>Toggle</th><th>Delete</th></tr>
    </thead>
    <tbody></tbody>
  </table>

<script>
async function loadKeys(){
  const res = await fetch("/admin/keys");
  const data = await res.json();
  const tbody = document.querySelector("#keysTable tbody");
  tbody.innerHTML = "";
  data.forEach(k=>{
    tbody.innerHTML += `<tr>
      <td>${k.key}</td>
      <td>${k.active ? "‚úÖ" : "‚ùå"}</td>
      <td>${k.expiry}</td>
      <td><button onclick="toggleKey('${k.key}')">Toggle</button></td>
      <td><button class="delete-btn" onclick="deleteKey('${k.key}')">üóëÔ∏è</button></td>
    </tr>`;
  });
}

async function addKey(){
  const newKey = document.getElementById("newKey").value;
  const days = document.getElementById("days").value;
  const res = await fetch("/admin/addkey", {
    method:"POST", headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({ newKey, days, active:true })
  });
  const data = await res.json();
  alert(data.message);
  loadKeys();
}

async function toggleKey(key){
  const res = await fetch("/admin/toggle", {
    method:"POST", headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({ key })
  });
  const data = await res.json();
  alert(data.message);
  loadKeys();
}

async function deleteKey(key){
  if(!confirm(`Are you sure you want to delete "${key}"?`)) return;
  const res = await fetch("/admin/delete", {
    method:"POST", headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({ key })
  });
  const data = await res.json();
  alert(data.message);
  loadKeys();
}

loadKeys();
</script>
</body>
</html>
